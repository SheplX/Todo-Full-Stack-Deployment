apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/proxy-buffer-size: "8k"
 {{- range .Values.ingress.tls }}
  {{- range .hosts }}
  name: "ingress-prod-{{ . }}" 
spec:
  tls:
    - hosts:
        - {{ . | quote }}
      secretName: "secret-prod-{{ . }}"
  rules:
    - host: {{ . | quote }}
      http:
        paths:
        - path: /
          pathType: Prefix
          backend:
            service:
              name: proxy
              port: 80
                name: http
           {{- end }}
           {{- end }}
